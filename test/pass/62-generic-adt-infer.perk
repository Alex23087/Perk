import "stdio.h"

type <T> list = Empty | Cons(T, list @ T)

fun sum_list (l : list @ int) : int {
    match (l) {
        Empty {return 0},
        Cons (var i, var rest) {return i + sum_list (rest)}
    }
}

type <T> Tree = Leaf (T) | Node (Tree @ T, Tree @ T)

fun <T> tree_fold (f : (T, T) => T, acc : T, t : Tree @ T) : T {
    match (t) {
        Leaf (var x) {return f(x, acc)},
        Node (var left, var right) {
            let acc1 := tree_fold @ T(f, acc, left);
            return tree_fold @ T(f, acc1, right);
        }
    }
}

fun <T> id (x : T) : T {
    return x;
}

fun main () : void {
    let banana : list@int = Empty@int;
    let banana2 := Cons (6, Cons (7, Empty@int));

    let string_banana : list @ char = Empty @ char;
    let tree := Node (Node (Leaf (1), Leaf (2)), Leaf (3));

    // printf("sum of banana: %d\n", sum_list (banana2));

    // printf("id of 5: %d\n", id @ int (5));
    // printf("id of 5: %d\n", id @ int (5));

    printf("sum of tree: %d\n", tree_fold @ int ((x : int, acc : int) : int {return x + acc}, 0, tree));

    return;
}

